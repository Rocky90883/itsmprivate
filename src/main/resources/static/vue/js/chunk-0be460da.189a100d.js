(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0be460da"],{"5a0b":function(t,e,a){"use strict";a.d(e,"d",(function(){return n})),a.d(e,"c",(function(){return i})),a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return s})),a.d(e,"e",(function(){return c}));var o=a("fd03");function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(o["a"])({url:"/workorder/DemandappAction/queryList.htm",method:"post",data:t})}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(o["a"])({url:"/workorder/DemandappAction/detail.htm",method:"post",params:{id:t}})}function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(o["a"])({url:"/workorder/DemandappAction/delete.htm",method:"post",params:{id:t}})}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(o["a"])({url:"/workorder/DemandappAction/addDemandapp.htm",method:"post",data:t})}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(o["a"])({url:"/workorder/DemandappAction/updateDemandapp.htm",method:"post",data:t})}},"6a7c":function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"record__content"},[a("div",{staticClass:"record__baseinfo"},[a("dividerTitle",{attrs:{title:"基本信息"}}),a("editForm",{ref:"editForm",attrs:{formConfig:t.formConfig,formData:t.editFormData}})],1),t.editFormData.status&&1==t.editFormData.status?a("div",{staticClass:"process_score"},[a("dividerTitle",{attrs:{title:"评分"}}),t.showScore?a("processScore",{attrs:{scoreSetting:t.scoreSetting,hideBtn:t.scoreHideBtn,showScore:t.showScore},on:{"update:showScore":function(e){t.showScore=e},"update:show-score":function(e){t.showScore=e}}}):t._e()],1):t._e(),a("div",{staticClass:"record__attach"},[a("dividerTitle",{attrs:{title:"附件"}}),a("attachTable",{ref:"attachFile",attrs:{attachSetting:t.attachSetting,hideBtn:t.hideBtn}})],1),"details"==t.pageType&&t.editFormData.status&&2!==t.editFormData.status?a("div",{staticClass:"record__workflow"},[a("dividerTitle",{attrs:{title:"工作流"}}),a("workFlow",{attrs:{currentFlowData:t.editFormData,beforeSubmit:t.beforeSubmit,otherParams:t.workFlowParams},on:{submitSuccess:t.workFlowSuccess}})],1):t._e()])},n=[],i=(a("d81d"),a("b0c0"),a("d3b7"),a("96cf"),a("1da1")),r=a("5530"),s=a("5a0b"),c={props:{formData:{type:Object,default:new Object},pageType:{type:String,default:""},defaultSet:{type:Boolean,default:!1}},data:function(){var t=this;return{hadSeleteData:[],editFormData:{suitableWorkArr:[]},trainingType:{},formConfig:{itemArr:[{label:"申请日期",prop:"billDate",type:"date",span:8},{label:"申请人",prop:"staffunName",idsStr:"employeeId",type:"user",trigger:"change",methods:function(e){var a=e[0],o=a.orgNodeName,n=a.orgNodeCode,i=a.mobile;t.$refs.editForm.setFormItem("depatName",o),t.$refs.editForm.setFormItem("depatCode",n),t.$refs.editForm.setFormItem("phone",i)}},{label:"申请部门",prop:"depatName",id:"depatCode",placeholder:"选择申请人后自动带出",type:"text"},{label:"联系号码",prop:"phone",type:"text",placeholder:"选择申请人后自动带出",rules:{validator:function(t,e,a){var o=/^[0-9]*$/;if(e){if(!o.test(e))return a(new Error("请填写正确的手机号码！"));a()}else;},trigger:"change"}},{type:"select",label:"应用系统名称",prop:"appsysName",id:"appsysId",seleteOption:this.$store.getters.systemType,methods:function(e){t.$refs.editForm.setFormItem("appsysId",e.value),t.$refs.editForm.setFormItem("appsysName",e.name)}},{label:"审批人",prop:"confirmManName",idsStr:"confirmMan",type:"user",isHide:"details"==this.pageType&&!this.isWorkFlowEdit,trigger:"change"},{label:"申请描述",prop:"appContent",type:"textarea",span:24,rows:4},{label:"备注",prop:"remark",type:"textarea",span:24,rows:4}]},procInstType:null,attachSetting:{title:"",select:!1,billType:this.procInstType,sourceId:"",btnArr:["add","delete","save"]},scoreSetting:{title:"",billType:"asset_regist",sourceId:"",data:[],btnArr:["save"]},scoreHideBtn:!1,coverList:[],dialogVisible:!1,activeName:"0",hideBtn:!1,showScore:!1,beforeSubmit:{methods:function(e){return t.submitBefore(e)}}}},computed:{workFlowParams:function(){var t=this.editFormData.procInstType;return 4===this.formData.status&&this.formData.workflowIsApprover?{procInstType:t||"",assignercodes:[this.editFormData.confirmMan]}:{procInstType:t||""}},isWorkFlowEdit:function(){return!(4!==this.formData.status||!this.formData.workflowIsApprover)}},mounted:function(){this.init()},methods:{init:function(){if("add"==this.pageType){var t={};this.defaultSet&&(t=Object(r["a"])({},this.formData)),this.editFormData=Object.assign({},t,{billDate:this.$utils.getNowDay()})}else this.getDetails(this.formData.id);"details"==this.pageType&&(this.isWorkFlowEdit||this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.attachSetting.sourceId=this.formData.id),"score"==this.pageType&&(this.scoreSetting.sourceId=this.formData.id,this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.showScore=!0)},getDetails:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var o,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(s["c"])(t);case 2:o=a.sent,n=o.data||{},e.procInstType=n.procInstType,e.attachSetting.sourceId=n.id,e.editFormData=Object.assign({},n,{confirmMan:n.empId,confirmManName:n.zystaffunName});case 7:case"end":return a.stop()}}),a)})))()},submitBefore:function(t){var e=this;return!this.isWorkFlowEdit||new Promise((function(t,a){e.$refs.editForm.getFormData().then((function(o){e.$set(o,"submitType",1),e.editFormData=Object.assign({},o),Object(s["e"])(o).then((function(e){t()})).catch((function(t){a(t)}))})).catch((function(t){console.log(t),a("表单信息未填写完整")}))}))},workFlowSuccess:function(){this.$emit("update:pageType","list")},getFormData:function(){return this.$refs.editForm.getFormData()}}},d=c,p=a("2877"),l=Object(p["a"])(d,o,n,!1,null,"e1ee8abc",null);e["a"]=l.exports},f524:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"informationSystemsApply h100"},[a("div",{staticClass:"page-main-box"},[a("KlTable",t._b({directives:[{name:"show",rawName:"v-show",value:"list"==t.pageType,expression:"pageType == 'list'"}],ref:"klTable"},"KlTable",t.tableConfig,!1)),"list"!==t.pageType?a("editPage",{attrs:{rightBtnArr:t.rightBtnArr},on:{goBackPage:t.goBackPage}},[a("addInfo",{ref:"editForm",attrs:{pageType:t.pageType,formData:t.formData},on:{"update:pageType":function(e){t.pageType=e},"update:page-type":function(e){t.pageType=e}}})],1):t._e()],1)])},n=[],i=(a("99af"),a("d3b7"),a("3835")),r=a("6a7c"),s=a("5a0b"),c=(a("2934"),{name:"informationSystemsApply",components:{addInfo:r["a"]},data:function(){var t=this;return{label:"",otherInfo:"",showMember:!1,showScore:!1,currentItem:{},orgMemberSelect:{},tableConfig:{showFixedHeight:!0,searchObj:{searchMethod:function(e,a){t.tableConfig.tableDataObj&&t.getTableData()},searchArr:[{type:"el-input",label:"服务单号",model:"orderNo",placeholder:"服务单号"},{type:"daterange",label:"申请日期",model:"billDate"},{type:"el-input",label:"申请人",model:"staffunName",placeholder:"申请人"}]},queryObj:{method:function(){t.getTableData()},queryData:{page:1,pageSize:15}},tableDataObj:{tableArr:[],total:null},operateArr:[{name:"新建",icon:"el-icon-plus",method:function(e){t.toAdd()}}],tableObj:{selectionShow:!1,indexShow:!0,tableMethods:{selection:function(e){t.selectionData=e}},showItems:[{name:"服务单号",prop:"orderNo",width:100},{name:"申请日期",prop:"billDate"},{name:"申请人",prop:"staffunName"},{name:"申请部门",prop:"depatName",id:"depatCode"},{name:"联系号码",prop:"phone"},{name:"应用系统名称",prop:"appsysName",id:"appsysId"},{name:"申请描述",prop:"appContent"},{name:"备注",prop:"remark"},{name:"审批人",prop:"auditorName",id:"auditor"},{name:"流程节点",prop:"stage"},{name:"流程状态",prop:"flowStatusName",id:"status"},{name:"操作",prop:"operate",width:150,scopeType:"button",fixed:"right",buttonArr:[{name:"详情",method:function(e){t.detailsInfo(e)},isShow:function(t,e){return!0},icon:"false"},{name:"审批",method:function(e){t.detailsInfo(e)},isShow:function(t,e){return t.workflowIsApprover},icon:"false"},{name:"编辑",method:function(e){t.editInfo(e)},isShow:function(t,e){return 2===t.status},icon:"false"},{name:"评分",method:function(e){t.score(e)},isShow:function(t,e){return 1===t.status},icon:"false"},{name:"删除",method:function(e){t.deleteInfo(e)},isShow:function(t,e){return 2===t.status},icon:"false"}]}]},paginationObj:{pageSizes:[15,30,50,100]},paginationIsshow:!0,showklTable:!1},pageType:"list",formData:{}}},computed:{rightBtnArr:function(){var t=this,e=[{text:"保存",icon:"el-icon-check",hide:"details"==this.pageType,methods:function(){t.doSubmit(2)}},{text:"提交",icon:"el-icon-finished",hide:"details"==this.pageType,methods:function(){t.doSubmit(1)}}];return e}},watch:{"tableConfig.queryObj.queryData.staffunName":function(t){""==t&&(this.tableConfig.queryObj.queryData.empId=null)},pageType:function(t){"list"===t&&this.getTableData()}},mounted:function(){this.getTableData()},methods:{toAdd:function(){this.pageType="add",this.formData={}},getTableData:function(){var t=this,e=Object.assign({},this.tableConfig.queryObj.queryData);e.pageCount=e.pageSize;var a=e.billDate;if(a){var o=Object(i["a"])(a,2),n=o[0],r=o[1];e.beginDate=n,e.endDate=r}this.$delete(e,"billDate"),this.$delete(e,"empId"),this.$delete(e,"pageSize"),Object(s["d"])(e).then((function(e){t.$set(t.tableConfig.tableDataObj,"tableArr",e.data.list||[]),t.$set(t.tableConfig.tableDataObj,"total",e.data.total||0)})).catch((function(e){t.$set(t.tableConfig.tableDataObj,"tableArr",[]),t.$set(t.tableConfig.tableDataObj,"total",0)}))},detailsInfo:function(t){this.pageType="details",this.formData=Object.assign({},t)},editInfo:function(t){this.pageType="edit",this.formData=Object.assign({},t)},score:function(t){this.pageType="score",this.formData=Object.assign({},t)},deleteInfo:function(t){var e=this;this.$confirm("是否确认删除","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["b"])(t.id).then((function(t){e.$message.success("操作成功"),e.getTableData()}))})).catch((function(t){}))},doSubmit:function(t){var e=this;this.$refs.editForm.getFormData().then((function(a){e.$set(a,"submitType",t),e.$delete(a,"confirmManName");var o=function(t){return t.id?Object(s["e"])(t):Object(s["a"])(t)};"2"==t||"1"==t&&a.confirmMan?o(a).then((function(a){e.$message.success("操作成功！"),2==t?(e.pageType="edit",a.data&&(e.formData.id=a.data),e.$refs.editForm.getDetails(e.formData.id)):e.pageType="list"})):e.$message.warning("请选择审批人！")})).catch((function(t){console.log(t)}))},addMethons:function(t){return t.id?new Promise((function(e,a){Object(s["e"])(t).then((function(t){e(t)})).catch((function(t){console.log(t),a(t)}))})):new Promise((function(e,a){Object(s["a"])(t).then((function(t){e(t)})).catch((function(t){console.log(t),a(t)}))}))},goBackPage:function(t){this.pageType="list"},toExport:function(){var t=Object({NODE_ENV:"production",VUE_APP_BASEURL:"",BASE_URL:""}).BASEURL,e="",a=Object.assign({},this.tableConfig.queryObj.queryData);for(var o in a.daterange&&(a.comeinStart=a.daterange[0]||"",a.comeinEnd=a.daterange[1]||"",delete a.daterange),a)e+="".concat(o,"=").concat(a[o],"&");e=e.substring(0,e.length-1);var n="".concat(t,"/trainRecord/exportAdmUnPass.htm?").concat(e);window.open(n)}}}),d=c,p=a("2877"),l=Object(p["a"])(d,o,n,!1,null,null,null);e["default"]=l.exports}}]);
//# sourceMappingURL=chunk-0be460da.189a100d.js.map