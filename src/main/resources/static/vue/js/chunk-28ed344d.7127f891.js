(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28ed344d"],{1585:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"h100"},[a("KlTable",t._b({directives:[{name:"show",rawName:"v-show",value:"list"==t.pageType,expression:"pageType == 'list'"}],ref:"klTable"},"KlTable",t.tableConfig,!1)),"list"!==t.pageType?a("editPage",{attrs:{rightBtnArr:t.rightBtnArr},on:{goBackPage:t.goBackPage}},[a("detailsInfo",{ref:"details",attrs:{formData:t.formData,pageType:t.pageType},on:{"update:pageType":function(e){t.pageType=e},"update:page-type":function(e){t.pageType=e}}}),a("span",{attrs:{slot:"contentText"},slot:"contentText"},[t._v(t._s(t.contentText))])],1):t._e()],1)},o=[],s=(a("99af"),a("3835")),i=a("2934"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flow-details"},[t.editFormData.id?a("div",{staticClass:"flow-details__baseinfo"},[a(t.componentName,{tag:"component",attrs:{formData:t.editFormData,pageType:t.pageFlowType},on:{"update:pageType":function(e){t.pageFlowType=e},"update:page-type":function(e){t.pageFlowType=e}}})],1):t._e()])},c=[],d=a("4636"),p=a("cbc5"),l=a("5fec"),u=a("f509"),m=a("6a7c"),f=a("8112"),h={accountapp:{componentName:"usersApply"},dataccessapp:{componentName:"dataAccessApply"},demandapp:{componentName:"informationSystemsApply"},msgapp:{componentName:"informationResourceApply"},officeapp:{componentName:"softwareApply"},repairapp:{componentName:"repairApply"}},g=h,b={props:{formData:{type:Object,default:{}},pageType:{type:String,default:"details"}},components:{dataAccessApply:d["a"],informationResourceApply:p["a"],usersApply:l["a"],softwareApply:u["a"],informationSystemsApply:m["a"],repairApply:f["a"]},watch:{pageFlowType:function(t){this.$emit("update:pageType",t)}},data:function(){return{pageFlowType:"details",editFormData:{},flowTypeObj:g}},created:function(){this.init()},computed:{componentName:function(){var t=this.flowTypeObj[this.formData.procInstType].componentName;return t}},methods:{init:function(){this.editFormData=Object.assign({},this.formData)}}},w=b,y=a("2877"),D=Object(y["a"])(w,n,c,!1,null,null,null),v=D.exports,S={components:{detailsInfo:v},props:["flowType"],data:function(){var t=this;return{tableConfig:{showFixedHeight:!0,searchObj:{searchMethod:function(e,a){t.tableConfig.tableDataObj&&t.getTableData()},searchArr:[{label:"服务类型",type:"el-select",model:"procInstType",option:this.$store.getters["dirtData"]("procInst_type")}]},queryObj:{method:function(){t.getTableData()},queryData:{type:this.flowType,page:1,pageSize:15}},tableDataObj:{tableArr:[],total:null},operateArr:[],tableObj:{selectionShow:!1,indexShow:!0,tableMethods:{selection:function(e){t.tableData=e}},showItems:[{name:"服务单号",prop:"orderNo"},{name:"模块名称",prop:"procInstName"},{name:"起草人",prop:"draftsman",width:40},{name:"申请人",prop:"staffunName",width:40,align:"center"},{name:"申请描述",prop:"appContent"},{name:"发起日期",prop:"billDate"},{name:"当前节点",prop:"currenttaskname"},{name:"当前审核人",prop:"auditorName"},{name:"审批状态",prop:"flowStatusName",width:50},{name:"操作",prop:"operate",width:60,scopeType:"button",fixed:"right",buttonArr:[{name:"详情",method:function(e){t.details(e)},isShow:function(t,e){return!0},icon:"false"}]}]},paginationObj:{pageSizes:[15,30,50,100]},paginationIsshow:!0,showklTable:!1},formData:{},pageType:"list",rightBtnArr:[]}},watch:{pageType:function(t){"list"===t&&this.getTableData()}},computed:{contentText:function(){var t=this.formData,e=t.procInstName,a=t.id;return"业务编号：【".concat(a,"】   所属模块：【").concat(e,"】")}},mounted:function(){this.init()},methods:{init:function(){var t=this.$route.query;t.id&&this.details(t),this.getTableData()},getTableData:function(){var t=this,e=Object.assign({},this.tableConfig.queryObj.queryData);e.pageCount=e.pageSize;var a=e.billDate;if(a){var r=Object(s["a"])(a,2),o=r[0],n=r[1];e.beginDate=o,e.endDate=n}delete e.billDate,delete e.pageSize,Object(i["i"])(e).then((function(e){t.$set(t.tableConfig.tableDataObj,"tableArr",e.data||[]),t.$set(t.tableConfig.tableDataObj,"total",e.total||0)})).catch((function(e){t.$set(t.tableConfig.tableDataObj,"tableArr",[]),t.$set(t.tableConfig.tableDataObj,"total",0)}))},details:function(t){var e=t.billId;this.formData=Object.assign({},{id:e},t),this.pageType="details"},goBackPage:function(t){this.$router.push({query:{}}),this.pageType="list"}}},F=S,T=Object(y["a"])(F,r,o,!1,null,null,null);e["a"]=T.exports},"19d6":function(t,e,a){"use strict";a.d(e,"e",(function(){return o})),a.d(e,"c",(function(){return s})),a.d(e,"d",(function(){return i})),a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return c})),a.d(e,"f",(function(){return d}));var r=a("fd03");function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/OfficeappAction/queryList.htm",method:"post",data:t})}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/OfficeappAction/queryRegist.htm",method:"post",data:t})}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(r["a"])({url:"/workorder/OfficeappAction/detail.htm",method:"post",params:{id:t}})}function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(r["a"])({url:"/workorder/OfficeappAction/delete.htm",method:"post",params:{id:t}})}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/OfficeappAction/addOfficeapp.htm",method:"post",data:t})}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/OfficeappAction/updateOfficeapp.htm",method:"post",data:t})}},3371:function(t,e,a){"use strict";a.d(e,"d",(function(){return o})),a.d(e,"c",(function(){return s})),a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return n})),a.d(e,"e",(function(){return c}));var r=a("fd03");function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/DataccessappAction/queryList.htm",method:"post",data:t})}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(r["a"])({url:"/workorder/DataccessappAction/detail.htm",method:"post",params:{id:t}})}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(r["a"])({url:"/workorder/DataccessappAction/delete.htm",method:"post",params:{id:t}})}function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/DataccessappAction/addDataccessapp.htm",method:"post",data:t})}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/DataccessappAction/updateDataccessapp.htm",method:"post",data:t})}},4636:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"record__content"},[a("div",{staticClass:"record__baseinfo"},[a("dividerTitle",{attrs:{title:"基本信息"}}),a("editForm",{ref:"editForm",attrs:{formConfig:t.formConfig,formData:t.editFormData}})],1),t.editFormData.status&&1==t.editFormData.status?a("div",{staticClass:"process_score"},[a("dividerTitle",{attrs:{title:"评分"}}),t.showScore?a("processScore",{attrs:{scoreSetting:t.scoreSetting,hideBtn:t.scoreHideBtn,showScore:t.showScore},on:{"update:showScore":function(e){t.showScore=e},"update:show-score":function(e){t.showScore=e}}}):t._e()],1):t._e(),a("div",{staticClass:"record__attach"},[a("dividerTitle",{attrs:{title:"附件"}}),a("attachTable",{ref:"attachFile",attrs:{attachSetting:t.attachSetting,hideBtn:t.hideBtn}})],1),"details"==t.pageType&&t.editFormData.status&&2!==t.editFormData.status?a("div",{staticClass:"record__workflow"},[a("dividerTitle",{attrs:{title:"工作流"}}),a("workFlow",{attrs:{currentFlowData:t.editFormData,beforeSubmit:t.beforeSubmit,otherParams:t.workFlowParams},on:{submitSuccess:t.workFlowSuccess}})],1):t._e()])},o=[],s=(a("d81d"),a("d3b7"),a("96cf"),a("1da1")),i=a("5530"),n=a("3371"),c={props:{formData:{type:Object,default:new Object},pageType:{type:String,default:""},defaultSet:{type:Boolean,default:!1}},data:function(){var t=this;return{hadSeleteData:[],editFormData:{suitableWorkArr:[]},trainingType:{},formConfig:{itemArr:[{label:"申请日期",prop:"billDate",type:"date",span:8},{label:"申请人",prop:"staffunName",idsStr:"employeeId",type:"user",trigger:"change",methods:function(e){var a=e[0],r=a.orgNodeName,o=a.orgNodeCode,s=a.mobile;t.$refs.editForm.setFormItem("depatName",r),t.$refs.editForm.setFormItem("depatCode",o),t.$refs.editForm.setFormItem("phone",s)}},{label:"申请部门",prop:"depatName",id:"depatCode",placeholder:"选择申请人后自动带出",type:"text"},{label:"联系号码",prop:"phone",type:"text",placeholder:"选择申请人后自动带出",rules:{validator:function(t,e,a){var r=/^1[3|4|5|6|7|8|9]\d{9}$/;if(e){if(!r.test(e))return a(new Error("请填写正确的手机号码！"));a()}else;},trigger:"change"}},{type:"select",label:"数据接入类型",prop:"apptype",seleteOption:this.$store.getters["dirtData"]("access_type"),formatter:function(e){return t.$store.getters["fineDirtDataName"]("access_type",e)}},{label:"审批人",prop:"confirmManName",idsStr:"confirmMan",type:"user",isHide:"details"==this.pageType&&!this.isWorkFlowEdit,trigger:"change"},{label:"申请描述",prop:"appContent",type:"textarea",span:24,rows:4},{label:"备注",prop:"remark",type:"textarea",span:24,rows:4}]},procInstType:null,attachSetting:{title:"",select:!1,billType:this.procInstType,sourceId:"",btnArr:["add","delete","save"]},scoreSetting:{title:"",billType:"asset_regist",sourceId:"",data:[],btnArr:["save"]},scoreHideBtn:!1,coverList:[],dialogVisible:!1,activeName:"0",hideBtn:!1,showScore:!1,beforeSubmit:{methods:function(e){return t.submitBefore(e)}}}},computed:{workFlowParams:function(){var t=this.editFormData.procInstType;return 4===this.formData.status&&this.formData.workflowIsApprover?{procInstType:t||"",assignercodes:[this.editFormData.confirmMan]}:{procInstType:t||""}},isWorkFlowEdit:function(){return!(4!==this.formData.status||!this.formData.workflowIsApprover)}},mounted:function(){this.init()},methods:{init:function(){if("add"==this.pageType){var t={};this.defaultSet&&(t=Object(i["a"])({},this.formData)),this.editFormData=Object.assign({},t,{billDate:this.$utils.getNowDay()})}else this.getDetails(this.formData.id);"details"==this.pageType&&(this.isWorkFlowEdit||this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.attachSetting.sourceId=this.formData.id),"score"==this.pageType&&(this.scoreSetting.sourceId=this.formData.id,this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.showScore=!0)},getDetails:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(n["c"])(t);case 2:r=a.sent,o=r.data||{},e.procInstType=o.procInstType,e.attachSetting.sourceId=o.id,e.editFormData=Object.assign({},o,{confirmMan:o.empId,confirmManName:o.zystaffunName});case 7:case"end":return a.stop()}}),a)})))()},submitBefore:function(t){var e=this;return!this.isWorkFlowEdit||new Promise((function(t,a){e.$refs.editForm.getFormData().then((function(r){e.$set(r,"submitType",1),e.editFormData=Object.assign({},r),Object(n["e"])(r).then((function(e){t()})).catch((function(t){a(t)}))})).catch((function(t){console.log(t),a("表单信息未填写完整")}))}))},workFlowSuccess:function(){this.$emit("update:pageType","list")},getFormData:function(){return this.$refs.editForm.getFormData()}}},d=c,p=a("2877"),l=Object(p["a"])(d,r,o,!1,null,"563c9b1c",null);e["a"]=l.exports},"5a0b":function(t,e,a){"use strict";a.d(e,"d",(function(){return o})),a.d(e,"c",(function(){return s})),a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return n})),a.d(e,"e",(function(){return c}));var r=a("fd03");function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/DemandappAction/queryList.htm",method:"post",data:t})}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(r["a"])({url:"/workorder/DemandappAction/detail.htm",method:"post",params:{id:t}})}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(r["a"])({url:"/workorder/DemandappAction/delete.htm",method:"post",params:{id:t}})}function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/DemandappAction/addDemandapp.htm",method:"post",data:t})}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/DemandappAction/updateDemandapp.htm",method:"post",data:t})}},"5c2e":function(t,e,a){"use strict";a.d(e,"d",(function(){return o})),a.d(e,"c",(function(){return s})),a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return n})),a.d(e,"e",(function(){return c}));var r=a("fd03");function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/RepairappAction/queryList.htm",method:"post",data:t})}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(r["a"])({url:"/workorder/RepairappAction/detail.htm",method:"post",params:{id:t}})}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(r["a"])({url:"/workorder/RepairappAction/delete.htm",method:"post",params:{id:t}})}function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/RepairappAction/addRepairapp.htm",method:"post",data:t})}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/RepairappAction/updateRepairapp.htm",method:"post",data:t})}},"5fec":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"record__content"},[a("div",{staticClass:"record__baseinfo"},[a("dividerTitle",{attrs:{title:"基本信息"}}),a("editForm",{ref:"editForm",attrs:{formConfig:t.formConfig,formData:t.editFormData}})],1),t.editFormData.status&&1==t.editFormData.status?a("div",{staticClass:"process_score"},[a("dividerTitle",{attrs:{title:"评分"}}),t.showScore?a("processScore",{attrs:{scoreSetting:t.scoreSetting,hideBtn:t.scoreHideBtn,showScore:t.showScore},on:{"update:showScore":function(e){t.showScore=e},"update:show-score":function(e){t.showScore=e}}}):t._e()],1):t._e(),a("div",{staticClass:"record__attach"},[a("dividerTitle",{attrs:{title:"附件"}}),a("attachTable",{ref:"attachFile",attrs:{attachSetting:t.attachSetting,hideBtn:t.hideBtn}})],1),"details"==t.pageType&&t.editFormData.status&&2!==t.editFormData.status?a("div",{staticClass:"record__workflow"},[a("dividerTitle",{attrs:{title:"工作流"}}),a("workFlow",{attrs:{currentFlowData:t.editFormData,beforeSubmit:t.beforeSubmit,otherParams:t.workFlowParams},on:{submitSuccess:t.workFlowSuccess}})],1):t._e()])},o=[],s=(a("d81d"),a("d3b7"),a("96cf"),a("1da1")),i=a("5530"),n=a("8620"),c={props:{formData:{type:Object,default:new Object},pageType:{type:String,default:""},defaultSet:{type:Boolean,default:!1}},data:function(){var t=this;return{hadSeleteData:[],editFormData:{suitableWorkArr:[]},trainingType:{},formConfig:{itemArr:[{label:"申请日期",prop:"billDate",type:"date",span:8},{label:"申请人",prop:"staffunName",idsStr:"employeeId",type:"user",trigger:"change",methods:function(e){var a=e[0],r=a.orgNodeName,o=a.orgNodeCode,s=a.mobile;t.$refs.editForm.setFormItem("depatName",r),t.$refs.editForm.setFormItem("depatCode",o),t.$refs.editForm.setFormItem("phone",s)}},{label:"申请部门",prop:"depatName",id:"depatCode",placeholder:"选择申请人后自动带出",type:"text"},{label:"联系号码",prop:"phone",type:"text",placeholder:"选择申请人后自动带出",rules:{validator:function(t,e,a){var r=/^[0-9]*$/;if(e){if(!r.test(e))return a(new Error("请填写正确的手机号码！"));a()}else;},trigger:"change"}},{type:"select",label:"申请类型",prop:"apptype",seleteOption:this.$store.getters["dirtData"]("acc_type"),formatter:function(e){return t.$store.getters["fineDirtDataName"]("acc_type",e)}},{type:"select",label:"业务类型",prop:"appsysName",id:"appsysId",seleteOption:this.$store.getters["dirtData"]("msg_type"),formatter:function(e){return t.$store.getters["fineDirtDataName"]("msg_type",e)}},{label:"审批人",prop:"confirmManName",idsStr:"confirmMan",type:"user",isHide:"details"==this.pageType&&!this.isWorkFlowEdit,trigger:"change"},{label:"申请描述",prop:"appContent",type:"textarea",span:24,rows:4},{label:"备注",prop:"remark",type:"textarea",span:24,rows:4}]},procInstType:null,attachSetting:{title:"",select:!1,billType:this.procInstType,sourceId:"",btnArr:["add","delete","save"]},scoreSetting:{title:"",billType:"asset_regist",sourceId:"",data:[],btnArr:["save"]},scoreHideBtn:!1,coverList:[],dialogVisible:!1,activeName:"0",hideBtn:!1,showScore:!1,beforeSubmit:{methods:function(e){return t.submitBefore(e)}}}},computed:{workFlowParams:function(){var t=this.editFormData.procInstType;return 4===this.formData.status&&this.formData.workflowIsApprover?{procInstType:t||"",assignercodes:[this.editFormData.confirmMan]}:{procInstType:t||""}},isWorkFlowEdit:function(){return!(4!==this.formData.status||!this.formData.workflowIsApprover)}},mounted:function(){this.init()},methods:{init:function(){if("add"==this.pageType){var t={};this.defaultSet&&(t=Object(i["a"])({},this.formData)),this.editFormData=Object.assign({},t,{billDate:this.$utils.getNowDay()})}else this.getDetails(this.formData.id);"details"==this.pageType&&(this.isWorkFlowEdit||this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.attachSetting.sourceId=this.formData.id),"score"==this.pageType&&(this.scoreSetting.sourceId=this.formData.id,this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.showScore=!0)},getDetails:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(n["c"])(t);case 2:r=a.sent,o=r.data||{},e.procInstType=o.procInstType,e.attachSetting.sourceId=o.id,e.editFormData=Object.assign({},o,{confirmMan:o.empId,confirmManName:o.zystaffunName});case 7:case"end":return a.stop()}}),a)})))()},submitBefore:function(t){var e=this;return!this.isWorkFlowEdit||new Promise((function(t,a){e.$refs.editForm.getFormData().then((function(r){e.$set(r,"submitType",1),e.editFormData=Object.assign({},r),Object(n["e"])(r).then((function(e){t()})).catch((function(t){a(t)}))})).catch((function(t){console.log(t),a("表单信息未填写完整")}))}))},workFlowSuccess:function(){this.$emit("update:pageType","list")},getFormData:function(){return this.$refs.editForm.getFormData()}}},d=c,p=a("2877"),l=Object(p["a"])(d,r,o,!1,null,"6245fea8",null);e["a"]=l.exports},"6a7c":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"record__content"},[a("div",{staticClass:"record__baseinfo"},[a("dividerTitle",{attrs:{title:"基本信息"}}),a("editForm",{ref:"editForm",attrs:{formConfig:t.formConfig,formData:t.editFormData}})],1),t.editFormData.status&&1==t.editFormData.status?a("div",{staticClass:"process_score"},[a("dividerTitle",{attrs:{title:"评分"}}),t.showScore?a("processScore",{attrs:{scoreSetting:t.scoreSetting,hideBtn:t.scoreHideBtn,showScore:t.showScore},on:{"update:showScore":function(e){t.showScore=e},"update:show-score":function(e){t.showScore=e}}}):t._e()],1):t._e(),a("div",{staticClass:"record__attach"},[a("dividerTitle",{attrs:{title:"附件"}}),a("attachTable",{ref:"attachFile",attrs:{attachSetting:t.attachSetting,hideBtn:t.hideBtn}})],1),"details"==t.pageType&&t.editFormData.status&&2!==t.editFormData.status?a("div",{staticClass:"record__workflow"},[a("dividerTitle",{attrs:{title:"工作流"}}),a("workFlow",{attrs:{currentFlowData:t.editFormData,beforeSubmit:t.beforeSubmit,otherParams:t.workFlowParams},on:{submitSuccess:t.workFlowSuccess}})],1):t._e()])},o=[],s=(a("d81d"),a("b0c0"),a("d3b7"),a("96cf"),a("1da1")),i=a("5530"),n=a("5a0b"),c={props:{formData:{type:Object,default:new Object},pageType:{type:String,default:""},defaultSet:{type:Boolean,default:!1}},data:function(){var t=this;return{hadSeleteData:[],editFormData:{suitableWorkArr:[]},trainingType:{},formConfig:{itemArr:[{label:"申请日期",prop:"billDate",type:"date",span:8},{label:"申请人",prop:"staffunName",idsStr:"employeeId",type:"user",trigger:"change",methods:function(e){var a=e[0],r=a.orgNodeName,o=a.orgNodeCode,s=a.mobile;t.$refs.editForm.setFormItem("depatName",r),t.$refs.editForm.setFormItem("depatCode",o),t.$refs.editForm.setFormItem("phone",s)}},{label:"申请部门",prop:"depatName",id:"depatCode",placeholder:"选择申请人后自动带出",type:"text"},{label:"联系号码",prop:"phone",type:"text",placeholder:"选择申请人后自动带出",rules:{validator:function(t,e,a){var r=/^[0-9]*$/;if(e){if(!r.test(e))return a(new Error("请填写正确的手机号码！"));a()}else;},trigger:"change"}},{type:"select",label:"应用系统名称",prop:"appsysName",id:"appsysId",seleteOption:this.$store.getters.systemType,methods:function(e){t.$refs.editForm.setFormItem("appsysId",e.value),t.$refs.editForm.setFormItem("appsysName",e.name)}},{label:"审批人",prop:"confirmManName",idsStr:"confirmMan",type:"user",isHide:"details"==this.pageType&&!this.isWorkFlowEdit,trigger:"change"},{label:"申请描述",prop:"appContent",type:"textarea",span:24,rows:4},{label:"备注",prop:"remark",type:"textarea",span:24,rows:4}]},procInstType:null,attachSetting:{title:"",select:!1,billType:this.procInstType,sourceId:"",btnArr:["add","delete","save"]},scoreSetting:{title:"",billType:"asset_regist",sourceId:"",data:[],btnArr:["save"]},scoreHideBtn:!1,coverList:[],dialogVisible:!1,activeName:"0",hideBtn:!1,showScore:!1,beforeSubmit:{methods:function(e){return t.submitBefore(e)}}}},computed:{workFlowParams:function(){var t=this.editFormData.procInstType;return 4===this.formData.status&&this.formData.workflowIsApprover?{procInstType:t||"",assignercodes:[this.editFormData.confirmMan]}:{procInstType:t||""}},isWorkFlowEdit:function(){return!(4!==this.formData.status||!this.formData.workflowIsApprover)}},mounted:function(){this.init()},methods:{init:function(){if("add"==this.pageType){var t={};this.defaultSet&&(t=Object(i["a"])({},this.formData)),this.editFormData=Object.assign({},t,{billDate:this.$utils.getNowDay()})}else this.getDetails(this.formData.id);"details"==this.pageType&&(this.isWorkFlowEdit||this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.attachSetting.sourceId=this.formData.id),"score"==this.pageType&&(this.scoreSetting.sourceId=this.formData.id,this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.showScore=!0)},getDetails:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(n["c"])(t);case 2:r=a.sent,o=r.data||{},e.procInstType=o.procInstType,e.attachSetting.sourceId=o.id,e.editFormData=Object.assign({},o,{confirmMan:o.empId,confirmManName:o.zystaffunName});case 7:case"end":return a.stop()}}),a)})))()},submitBefore:function(t){var e=this;return!this.isWorkFlowEdit||new Promise((function(t,a){e.$refs.editForm.getFormData().then((function(r){e.$set(r,"submitType",1),e.editFormData=Object.assign({},r),Object(n["e"])(r).then((function(e){t()})).catch((function(t){a(t)}))})).catch((function(t){console.log(t),a("表单信息未填写完整")}))}))},workFlowSuccess:function(){this.$emit("update:pageType","list")},getFormData:function(){return this.$refs.editForm.getFormData()}}},d=c,p=a("2877"),l=Object(p["a"])(d,r,o,!1,null,"e1ee8abc",null);e["a"]=l.exports},8112:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"record__content"},[a("div",{staticClass:"record__baseinfo"},[a("dividerTitle",{attrs:{title:"基本信息"}}),a("editForm",{ref:"editForm",attrs:{formConfig:t.formConfig,formData:t.editFormData}})],1),t.editFormData.status&&1==t.editFormData.status?a("div",{staticClass:"process_score"},[a("dividerTitle",{attrs:{title:"评分"}}),t.showScore?a("processScore",{attrs:{scoreSetting:t.scoreSetting,hideBtn:t.scoreHideBtn,showScore:t.showScore},on:{"update:showScore":function(e){t.showScore=e},"update:show-score":function(e){t.showScore=e}}}):t._e()],1):t._e(),a("div",{staticClass:"record__attach"},[a("dividerTitle",{attrs:{title:"附件"}}),a("attachTable",{ref:"attachFile",attrs:{attachSetting:t.attachSetting,hideBtn:t.hideBtn}})],1),"details"==t.pageType&&t.editFormData.status&&2!==t.editFormData.status?a("div",{staticClass:"record__workflow"},[a("dividerTitle",{attrs:{title:"工作流"}}),a("workFlow",{attrs:{currentFlowData:t.editFormData,beforeSubmit:t.beforeSubmit,otherParams:t.workFlowParams},on:{submitSuccess:t.workFlowSuccess}})],1):t._e()])},o=[],s=(a("d81d"),a("b0c0"),a("d3b7"),a("96cf"),a("1da1")),i=a("5530"),n=a("5c2e"),c={props:{formData:{type:Object,default:new Object},pageType:{type:String,default:""},defaultSet:{type:Boolean,default:!1}},data:function(){var t=this;return{hadSeleteData:[],editFormData:{suitableWorkArr:[]},trainingType:{},formConfig:{itemArr:[{label:"申请日期",prop:"billDate",type:"date",span:8},{label:"申请人",prop:"staffunName",idsStr:"employeeId",type:"user",trigger:"change",methods:function(e){var a=e[0],r=a.orgNodeName,o=a.orgNodeCode,s=a.mobile;t.$refs.editForm.setFormItem("depatName",r),t.$refs.editForm.setFormItem("depatCode",o),t.$refs.editForm.setFormItem("phone",s)}},{label:"申请部门",prop:"depatName",id:"depatCode",placeholder:"选择申请人后自动带出",type:"text"},{label:"联系号码",prop:"phone",type:"text",placeholder:"选择申请人后自动带出",rules:{validator:function(t,e,a){var r=/^[0-9]*$/;if(e){if(!r.test(e))return a(new Error("请填写正确的手机号码！"));a()}else;},trigger:"change"}},{type:"select",label:"硬件类",prop:"fixedtype",seleteOption:this.$store.getters["dirtData"]("fixed_type"),formatter:function(e){return t.$store.getters["fineDirtDataName"]("fixed_type",e)}},{type:"select",label:"办公软件类",prop:"softtype",seleteOption:this.$store.getters["dirtData"]("soft_type"),formatter:function(e){return t.$store.getters["fineDirtDataName"]("soft_type",e)}},{type:"select",label:"业务系统类",prop:"apptype",placeholder:"请选择业务系统类",seleteOption:this.$store.getters["dirtData"]("app_type"),formatter:function(e){return t.$store.getters["fineDirtDataName"]("app_type",e)}},{type:"select",label:"应用系统名称",prop:"appsysName",id:"appsysId",placeholder:"请选择应用系统名称",seleteOption:this.$store.getters.systemType,methods:function(e){t.$refs.editForm.setFormItem("appsysId",e.value),t.$refs.editForm.setFormItem("appsysName",e.name)}},{label:"申请描述",prop:"appContent",type:"textarea",span:24,rows:4},{label:"备注",prop:"remark",type:"textarea",span:24,rows:4}]},procInstType:null,attachSetting:{title:"",select:!1,billType:"asset_regist",sourceId:"",btnArr:["add","delete","save"]},scoreSetting:{title:"",billType:this.procInstType,sourceId:"",data:[],btnArr:["save"]},scoreHideBtn:!1,coverList:[],dialogVisible:!1,activeName:"0",hideBtn:!1,showScore:!1,beforeSubmit:{methods:function(e){return t.submitBefore(e)}}}},computed:{workFlowParams:function(){var t=this.editFormData.procInstType;return 4===this.formData.status&&this.formData.workflowIsApprover?{procInstType:t||"",assignercodes:[this.editFormData.confirmMan]}:{procInstType:t||""}},isWorkFlowEdit:function(){return!(4!==this.formData.status||!this.formData.workflowIsApprover)}},mounted:function(){this.init()},methods:{init:function(){if("add"==this.pageType){var t={};this.defaultSet&&(t=Object(i["a"])({},this.formData)),this.editFormData=Object.assign({},t,{billDate:this.$utils.getNowDay()})}else this.getDetails(this.formData.id);"details"==this.pageType&&(this.isWorkFlowEdit||this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.attachSetting.sourceId=this.formData.id),"score"==this.pageType&&(this.scoreSetting.sourceId=this.formData.id,this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.showScore=!0)},getDetails:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(n["c"])(t);case 2:r=a.sent,o=r.data||{},e.procInstType=o.procInstType,e.attachSetting.sourceId=o.id,e.editFormData=Object.assign({},o,{confirmMan:o.empId,confirmManName:o.zystaffunName});case 7:case"end":return a.stop()}}),a)})))()},submitBefore:function(t){var e=this;return!this.isWorkFlowEdit||new Promise((function(t,a){e.$refs.editForm.getFormData().then((function(r){e.$set(r,"submitType",1),e.editFormData=Object.assign({},r),Object(n["e"])(r).then((function(e){t()})).catch((function(t){a(t)}))})).catch((function(t){console.log(t),a("表单信息未填写完整")}))}))},workFlowSuccess:function(){this.$emit("update:pageType","list")},getFormData:function(){return this.$refs.editForm.getFormData()}}},d=c,p=a("2877"),l=Object(p["a"])(d,r,o,!1,null,"330f7e4a",null);e["a"]=l.exports},8620:function(t,e,a){"use strict";a.d(e,"d",(function(){return o})),a.d(e,"c",(function(){return s})),a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return n})),a.d(e,"e",(function(){return c}));var r=a("fd03");function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/AccountappAction/queryList.htm",method:"post",data:t})}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(r["a"])({url:"/workorder/AccountappAction/detail.htm",method:"post",params:{id:t}})}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(r["a"])({url:"/workorder/AccountappAction/delete.htm",method:"post",params:{id:t}})}function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/AccountappAction/addAccountapp.htm",method:"post",data:t})}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/AccountappAction/updateAccountapp.htm",method:"post",data:t})}},"908b":function(t,e,a){"use strict";a.d(e,"d",(function(){return o})),a.d(e,"c",(function(){return s})),a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return n})),a.d(e,"e",(function(){return c}));var r=a("fd03");function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/msgappAction/queryList.htm",method:"post",data:t})}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(r["a"])({url:"/workorder/msgappAction/detail.htm",method:"post",params:{id:t}})}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(r["a"])({url:"/workorder/msgappAction/delete.htm",method:"post",params:{id:t}})}function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/msgappAction/addMsgapp.htm",method:"post",data:t})}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/workorder/msgappAction/updateMsgapp.htm",method:"post",data:t})}},cbc5:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"record__content"},[a("div",{staticClass:"record__baseinfo"},[a("dividerTitle",{attrs:{title:"基本信息"}}),a("editForm",{ref:"editForm",attrs:{formConfig:t.formConfig,formData:t.editFormData},scopedSlots:t._u([{key:"assetsNumber",fn:function(e){var r=e.editFormInfo;return[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请选择资产信息",readonly:"",disabled:"details"==t.pageType&&!t.isWorkFlowEdit,size:"mini"},model:{value:r.assetsNumber,callback:function(e){t.$set(r,"assetsNumber",e)},expression:"editFormInfo.assetsNumber"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){return e.stopPropagation(),t.goSeleteAsset(e)}},slot:"append"})],1)]}}])})],1),t.editFormData.status&&1==t.editFormData.status?a("div",{staticClass:"process_score"},[a("dividerTitle",{attrs:{title:"评分"}}),t.showScore?a("processScore",{attrs:{scoreSetting:t.scoreSetting,hideBtn:t.scoreHideBtn,showScore:t.showScore},on:{"update:showScore":function(e){t.showScore=e},"update:show-score":function(e){t.showScore=e}}}):t._e()],1):t._e(),a("div",{staticClass:"record__attach"},[a("dividerTitle",{attrs:{title:"附件"}}),a("attachTable",{ref:"attachFile",attrs:{attachSetting:t.attachSetting,hideBtn:t.hideBtn}})],1),"details"==t.pageType&&t.editFormData.status&&2!==t.editFormData.status?a("div",{staticClass:"record__workflow"},[a("dividerTitle",{attrs:{title:"工作流"}}),a("workFlow",{attrs:{currentFlowData:t.editFormData,beforeSubmit:t.beforeSubmit,otherParams:t.workFlowParams},on:{submitSuccess:t.workFlowSuccess}})],1):t._e(),t.showSelete?a("assetSelete",{attrs:{hadSeleteData:t.hadSeleteData,showSelete:t.showSelete,userID:t.employeeId},on:{changeSelete:t.changeSeleteAsset,"update:showSelete":function(e){t.showSelete=e},"update:show-selete":function(e){t.showSelete=e}}}):t._e()],1)},o=[],s=(a("d81d"),a("d3b7"),a("3835")),i=(a("96cf"),a("1da1")),n=a("5530"),c=a("908b"),d={props:{formData:{type:Object,default:new Object},pageType:{type:String,default:""},defaultSet:{type:Boolean,default:!1}},data:function(){var t=this;return{hadSeleteData:[],employeeId:null,showSelete:!1,editFormData:{suitableWorkArr:[]},trainingType:{},formConfig:{itemArr:[{label:"申请日期",prop:"billDate",type:"date",span:8},{label:"申请人",prop:"staffunName",idsStr:"employeeId",type:"user",trigger:"change",methods:function(e){var a=e[0],r=a.orgNodeName,o=a.orgNodeCode,s=a.mobile,i=a.id;t.employeeId=i,t.$refs.editForm.setFormItem("depatName",r),t.$refs.editForm.setFormItem("depatCode",o),t.$refs.editForm.setFormItem("phone",s)}},{label:"申请部门",prop:"depatName",id:"depatCode",disabled:!0,placeholder:"选择申请人后自动带出",type:"text"},{label:"联系号码",prop:"phone",type:"text",placeholder:"选择申请人后自动带出",rules:{validator:function(t,e,a){var r=/^[0-9]*$/;if(e){if(!r.test(e))return a(new Error("请填写正确的手机号码！"));a()}else;},trigger:"change"}},{label:"资产编号",prop:"assetsNumber",type:"text"},{type:"text",label:"资产类型",prop:"assetTypeName",placeholder:"选择资产后自动带出",disabled:!0},{label:"资产型号",prop:"goodsModel",type:"text",placeholder:"选择资产后自动带出",disabled:!0},{type:"select",label:"业务类型",prop:"apptype",seleteOption:this.$store.getters["dirtData"]("msg_type"),formatter:function(e){return t.$store.getters["fineDirtDataName"]("msg_type",e)}},{label:"审批人",prop:"confirmManName",idsStr:"confirmMan",type:"user",isHide:"details"==this.pageType&&!this.isWorkFlowEdit,trigger:"change"},{label:"申请描述",prop:"appContent",type:"textarea",span:24,rows:4},{label:"备注",prop:"remark",type:"textarea",span:24,rows:4}]},procInstType:null,attachSetting:{title:"",select:!1,billType:this.procInstType,sourceId:"",btnArr:["add","delete","save"]},scoreSetting:{title:"",billType:"asset_regist",sourceId:"",data:[],btnArr:["save"]},scoreHideBtn:!1,coverList:[],dialogVisible:!1,activeName:"0",hideBtn:!1,showScore:!1,beforeSubmit:{methods:function(e){return t.submitBefore(e)}}}},computed:{workFlowParams:function(){var t=this.editFormData.procInstType;return 4===this.formData.status&&this.formData.workflowIsApprover?{procInstType:t||"",assignercodes:[this.editFormData.confirmMan]}:{procInstType:t||""}},isWorkFlowEdit:function(){return!(4!==this.formData.status||!this.formData.workflowIsApprover)}},mounted:function(){this.init()},methods:{init:function(){if("add"==this.pageType){var t={};this.defaultSet&&(t=Object(n["a"])({},this.formData)),this.editFormData=Object.assign({},t,{billDate:this.$utils.getNowDay()})}else this.getDetails(this.formData.id);"details"==this.pageType&&(this.isWorkFlowEdit||this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.attachSetting.sourceId=this.formData.id),"score"==this.pageType&&(this.scoreSetting.sourceId=this.formData.id,this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.showScore=!0)},getDetails:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(c["c"])(t);case 2:r=a.sent,o=r.data||{},e.procInstType=o.procInstType,e.attachSetting.sourceId=o.id,e.editFormData=Object.assign({},o,{confirmMan:o.empId,confirmManName:o.zystaffunName});case 7:case"end":return a.stop()}}),a)})))()},submitBefore:function(t){var e=this;return!this.isWorkFlowEdit||new Promise((function(t,a){e.$refs.editForm.getFormData().then((function(r){var o=r.billDate,s=r.employeeId,i=r.depatcode,n=r.phone,d=r.assetsNumber,p=r.assetTypeName,l=r.goodsModel,u=r.apptype,m=r.confirmMan,f=r.appContent,h=r.remark,g=r.sourceId,b=r.id,w={billDate:o,employeeId:s,depatcode:i,phone:n,assetsNumber:d,assetTypeName:p,goodsModel:l,apptype:u,confirmMan:m,appContent:f,remark:h,sourceId:g,submitType:1,id:b};e.editFormData=Object.assign({},r),Object(c["e"])(w).then((function(e){t()})).catch((function(t){a(t)}))})).catch((function(t){a("表单信息未填写完整")}))}))},workFlowSuccess:function(){this.$emit("update:pageType","list")},getFormData:function(){return this.$refs.editForm.getFormData()},goSeleteAsset:function(){if(this.employeeId){if("details"==this.pageType)return;var t=this.$refs.editForm.getFormItem("sourceId");this.hadSeleteData=[{id:t}],this.showSelete=!0}else this.$message.warning("请先选择申请人")},changeSeleteAsset:function(t){var e=Object(s["a"])(t,1),a=e[0],r=a.assetsNumber,o=a.assetTypeName,i=(a.assetTypeId,a.goodsModel),n=a.id;this.$refs.editForm.setFormItem("assetsNumber",r),this.$refs.editForm.setFormItem("assetTypeName",o),this.$refs.editForm.setFormItem("goodsModel",i),this.$refs.editForm.setFormItem("sourceId",n)}}},p=d,l=a("2877"),u=Object(l["a"])(p,r,o,!1,null,"10cc4f78",null);e["a"]=u.exports},f509:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"record__content"},[a("div",{staticClass:"record__baseinfo"},[a("dividerTitle",{attrs:{title:"基本信息"}}),a("editForm",{ref:"editForm",attrs:{formConfig:t.formConfig,formData:t.editFormData},scopedSlots:t._u([{key:"assetsNumber",fn:function(e){var r=e.editFormInfo;return[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请选择资产信息",readonly:"",disabled:"details"==t.pageType&&!t.isWorkFlowEdit,size:"mini"},model:{value:r.assetsNumber,callback:function(e){t.$set(r,"assetsNumber",e)},expression:"editFormInfo.assetsNumber"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){return e.stopPropagation(),t.goSeleteAsset(e)}},slot:"append"})],1)]}}])})],1),t.editFormData.status&&1==t.editFormData.status?a("div",{staticClass:"process_score"},[a("dividerTitle",{attrs:{title:"评分"}}),t.showScore?a("processScore",{attrs:{scoreSetting:t.scoreSetting,hideBtn:t.scoreHideBtn,showScore:t.showScore},on:{"update:showScore":function(e){t.showScore=e},"update:show-score":function(e){t.showScore=e}}}):t._e()],1):t._e(),a("div",{staticClass:"software_details"},[a("dividerTitle",{attrs:{title:"软件申请明细"}}),a("editTable",{ref:"checkSoftware",attrs:{tableSetting:t.detailsSetting,hideBtn:t.hideBtn},on:{handleClickAdd:t.addSoftware}})],1),"details"==t.pageType&&t.editFormData.status&&2!==t.editFormData.status?a("div",{staticClass:"record__workflow"},[a("dividerTitle",{attrs:{title:"工作流"}}),a("workFlow",{attrs:{currentFlowData:t.editFormData,beforeSubmit:t.beforeSubmit,otherParams:t.workFlowParams},on:{submitSuccess:t.workFlowSuccess}})],1):t._e(),t.showSelete?a("softwareSelete",{attrs:{hadSeleteData:t.hadSeleteData,showSelete:t.showSelete},on:{changeSelete:t.changeSeleteSorft,"update:showSelete":function(e){t.showSelete=e},"update:show-selete":function(e){t.showSelete=e}}}):t._e(),t.showAssetSelete?a("assetSelete",{attrs:{hadSeleteData:t.assetSeleteData,showSelete:t.showAssetSelete,userID:t.employeeId},on:{changeSelete:t.changeSeleteAsset,"update:showSelete":function(e){t.showAssetSelete=e},"update:show-selete":function(e){t.showAssetSelete=e}}}):t._e()],1)},o=[],s=(a("4160"),a("d81d"),a("d3b7"),a("159b"),a("3835")),i=(a("96cf"),a("1da1")),n=a("5530"),c=a("19d6"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"software-selete"},[a("dialogPublic",{attrs:{title:"可选软件",show:t.showDialong,fullscreen:"",appendTobody:""},on:{"update:show":function(e){t.showDialong=e},doSubmit:t.doSave,doClose:t.doClose}},[a("seleteTable",{ref:"seleteTable",attrs:{tableSetting:t.tableSetting,hadData:t.hadSeleteData}})],1)],1)},p=[],l=a("7b5c"),u={props:{hadSeleteData:{type:Array,default:new Array},showSelete:{type:Boolean,default:!0}},components:{seleteTable:l["a"]},data:function(){return{tableSetting:{maxHeight:"600px",column:[{label:"资产分类",prop:"assetTypeName"},{label:"资产型号",prop:"goodsModel"},{label:"登记单号",prop:"billNo"},{label:"库存数量",prop:"instock"}],data:[]},showDialong:!0}},created:function(){this.getAssets()},methods:{getAssets:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["c"])();case 2:a=e.sent,r=a.data,t.$refs.seleteTable.setTableData(r||[]);case 5:case"end":return e.stop()}}),e)})))()},doClose:function(){this.$emit("update:showSelete",!1)},doSave:function(){var t=this.$refs.seleteTable.getSeleteData();this.$emit("changeSelete",t),this.doClose()}}},m=u,f=a("2877"),h=Object(f["a"])(m,d,p,!1,null,null,null),g=h.exports,b={props:{formData:{type:Object,default:new Object},pageType:{type:String,default:""},defaultSet:{type:Boolean,default:!1}},components:{softwareSelete:g},data:function(){var t=this;return{hadSeleteData:[],assetSeleteData:[],employeeId:null,showSelete:!1,showAssetSelete:!1,editFormData:{suitableWorkArr:[]},trainingType:{},hideBtn:!1,maxNum:0,detailsSetting:{title:"",select:!0,addMethons:!0,maxHeight:400,btnArr:["add","delete"],column:[{label:"资产分类",prop:"assetTypeName",readonly:!0,disabled:!0,type:"text"},{label:"资产型号",prop:"goodsModel",type:"text",readonly:!0,disabled:!0},{label:"登记单号",prop:"billNo",type:"text",readonly:!0,disabled:!0},{label:"申请时库存",prop:"instock",type:"number",min:0,disabled:!0},{label:"数量",prop:"qty",type:"number",min:0,precision:0,step:1,disabled:!1,required:!0}]},formConfig:{itemArr:[{label:"申请日期",prop:"billDate",type:"date",span:8},{label:"申请人",prop:"staffunName",idsStr:"employeeId",type:"user",trigger:"change",methods:function(e){var a=e[0],r=a.orgNodeName,o=a.orgNodeCode,s=a.mobile,i=a.id;t.employeeId=i,t.$refs.editForm.setFormItem("depatName",r),t.$refs.editForm.setFormItem("depatCode",o),t.$refs.editForm.setFormItem("phone",s)}},{label:"申请部门",prop:"depatName",id:"depatCode",disabled:!0,placeholder:"选择申请人后自动带出",type:"text"},{label:"联系号码",prop:"phone",type:"text",placeholder:"选择申请人后自动带出",rules:{validator:function(t,e,a){var r=/^[0-9]*$/;if(e){if(!r.test(e))return a(new Error("请填写正确的手机号码！"));a()}else;},trigger:"change"}},{label:"资产编号",prop:"assetsNumber",type:"text"},{type:"text",label:"资产类型",prop:"assetTypeName",placeholder:"选择资产后自动带出",disabled:!0},{label:"资产型号",prop:"gModel",type:"text",placeholder:"选择资产后自动带出",disabled:!0},{type:"select",label:"申请类型",prop:"apptype",seleteOption:this.$store.getters["dirtData"]("soft_type"),formatter:function(e){return t.$store.getters["fineDirtDataName"]("soft_type",e)}},{label:"审批人",prop:"confirmManName",idsStr:"confirmMan",type:"user",isHide:"details"==this.pageType&&!this.isWorkFlowEdit,trigger:"change"},{label:"申请描述",prop:"appContent",type:"textarea",span:24,rows:4},{label:"备注",prop:"remark",type:"textarea",span:24,rows:4}]},procInstType:null,scoreSetting:{title:"",billType:"asset_regist",sourceId:"",data:[],btnArr:["save"]},scoreHideBtn:!1,coverList:[],dialogVisible:!1,activeName:"0",showScore:!1,beforeSubmit:{methods:function(e){return t.submitBefore(e)}}}},computed:{workFlowParams:function(){var t=this.editFormData.procInstType;return 4===this.formData.status&&this.formData.workflowIsApprover?{procInstType:t||"",assignercodes:[this.editFormData.confirmMan]}:{procInstType:t||""}},isWorkFlowEdit:function(){return!(4!==this.formData.status||!this.formData.workflowIsApprover)}},mounted:function(){this.init()},methods:{init:function(){if("add"==this.pageType){var t={};this.defaultSet&&(t=Object(n["a"])({},this.formData)),this.editFormData=Object.assign({},t,{billDate:this.$utils.getNowDay()})}else this.getDetails(this.formData.id);"details"==this.pageType&&(this.isWorkFlowEdit||(this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.hideBtn=!0),this.hideBtn=!0),"details"==this.pageType&&"4"==this.formData.status&&(this.hideBtn=!1),"1"==this.formData.status&&(this.hideBtn=!0),"score"==this.pageType&&(this.scoreSetting.sourceId=this.formData.id,this.formConfig.itemArr.map((function(t){return t.disabled=!0})),this.showScore=!0)},getDetails:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,o,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(c["d"])(t);case 2:r=a.sent,o=r.data||{},e.editFormData=Object.assign({},o,{confirmMan:o.empId,confirmManName:o.zystaffunName}),o&&(e.employeeId=e.editFormData.employeeId),s=r.data.det,"edit"===e.pageType&&s.map((function(t){t.editable=!0})),e.$refs.checkSoftware.setTableData(s);case 9:case"end":return a.stop()}}),a)})))()},submitBefore:function(t){var e=this;return!this.isWorkFlowEdit||new Promise((function(t,a){var r=null;e.$refs.editForm.getFormData().then((function(o){r=o,e.$set(r,"submitType",1),e.editFormData=Object.assign({},o),e.$refs.checkSoftware.getTableData().then((function(o){if(o.length){var s=!0;o.forEach((function(t){var e=parseInt(t.instock);t.qty>e&&(s=!1)})),s?(r.det=o,e.$delete(r,"confirmManName"),e.$delete(r,"appsysName"),e.$delete(r,"assetTypeName"),Object(c["f"])(r).then((function(e){t()})).catch((function(t){a(t)}))):e.$message.warning("申请数量不能大于库存数量！")}else e.$message.warning("请选择需申请的软件！")}))})).catch((function(t){console.log(t),a("表单信息未填写完整")}))}))},workFlowSuccess:function(){this.$emit("update:pageType","list")},getFormData:function(){return this.$refs.editForm.getFormData()},getTableData:function(){return this.$refs.checkSoftware.getTableData()},addSoftware:function(t,e){this.showSelete=!0},changeSeleteSorft:function(t){var e=this,a=Object(s["a"])(t,1);a[0];t.map((function(t){t.qty=1,t.sourceId=t.id,t.editable=!0,e.$delete(t,"id")})),this.$refs.checkSoftware.setTableData(t||[])},goSeleteAsset:function(){if(this.employeeId){if("details"==this.pageType)return;var t=this.$refs.editForm.getFormItem("sourceId");this.assetSeleteData=[{id:t}],this.showAssetSelete=!0}else this.$message.warning("请先选择申请人")},changeSeleteAsset:function(t){var e=Object(s["a"])(t,1),a=e[0],r=a.assetsNumber,o=a.assetTypeName,i=(a.assetTypeId,a.goodsModel),n=a.id;this.$refs.editForm.setFormItem("assetsNumber",r),this.$refs.editForm.setFormItem("assetTypeName",o),this.$refs.editForm.setFormItem("assetsId",n),this.$refs.editForm.setFormItem("gModel",i)}}},w=b,y=Object(f["a"])(w,r,o,!1,null,"953dacf2",null);e["a"]=y.exports}}]);
//# sourceMappingURL=chunk-28ed344d.7127f891.js.map