(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2163f6"],{c23d:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"assetParameter h100"},[a("div",{staticClass:"page-main-box"},[a("KlTable",e._b({directives:[{name:"show",rawName:"v-show",value:"list"==e.pageType,expression:"pageType == 'list'"}],ref:"klTable"},"KlTable",e.tableConfig,!1)),"list"!==e.pageType?a("editPage",{attrs:{rightBtnArr:e.rightBtnArr},on:{goBackPage:e.goBackPage}},[a("addInfo",{ref:"editForm",attrs:{pageType:e.pageType,formData:e.formData}})],1):e._e()],1)])},o=[],i=(a("d3b7"),a("3835")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"record__content"},[a("div",{staticClass:"record__baseinfo"},[a("dividerTitle",{attrs:{title:"基本信息"}}),a("editForm",{ref:"editForm",attrs:{formConfig:e.formConfig,formData:e.editFormData},scopedSlots:e._u([{key:"comName",fn:function(t){var n=t.editFormInfo;return[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请选择开发商",readonly:"",disabled:"details"==e.pageType&&!e.isWorkFlowEdit,size:"mini"},model:{value:n.comName,callback:function(t){e.$set(n,"comName",t)},expression:"editFormInfo.comName"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return t.stopPropagation(),e.getDevelopers(t)}},slot:"append"})],1)]}}])})],1),e.showSelete?a("developersSelete",{attrs:{hadSeleteData:e.hadSeleteData,showSelete:e.showSelete},on:{changeSelete:e.selectDevelopers,"update:showSelete":function(t){e.showSelete=t},"update:show-selete":function(t){e.showSelete=t}}}):e._e()],1)},s=[],l=(a("d81d"),a("96cf"),a("1da1")),c=a("fd03");function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(c["a"])({url:"/maintain/AppSysAction/queryList.htm",method:"post",data:e})}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(c["a"])({url:"/maintain/AppSysAction/detail.htm",method:"post",params:{id:e}})}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(c["a"])({url:"/maintain/AppSysAction/deleteAppSys.htm",method:"post",data:{id:e}})}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(c["a"])({url:"/maintain/AppSysAction/addAppSys.htm",method:"post",data:e})}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(c["a"])({url:"/maintain/AppSysAction/updateAppSys.htm",method:"post",data:e})}var f={props:{formData:{type:Object,default:new Object},pageType:{type:String,default:""}},data:function(){return{editFormData:{suitableWorkArr:[]},trainingType:{},formConfig:{itemArr:[{label:"系统名称",prop:"sysName",placeholder:"请输入系统名称",required:!0,type:"text"},{label:"主办人",prop:"empName",span:8},{label:"开发商",prop:"comName",id:"companyId",type:"text"},{label:"开发商号码",prop:"phone",placeholder:"选择开发商后自动填入",type:"text"},{label:"建设时间",placeholder:"请选择建设时间",prop:"buildDate",type:"date"},{label:"预计完工时间",placeholder:"请选择预计完工时间",prop:"planDate",type:"date"},{label:"上线时间",placeholder:"请选择上线时间",prop:"onlineDate",type:"date"},{label:"备注",prop:"remark",type:"textarea",span:24,rows:4}]},coverList:[],dialogVisible:!1,hadSeleteData:[],showSelete:!1,procInstType:null,attachSetting:{title:"",select:!1,billType:this.procInstType,sourceId:"",btnArr:["add","delete","save"]},hideBtn:!1,activeName:"0"}},computed:{},created:function(){this.init()},methods:{init:function(){"add"!=this.pageType?this.getDetails(this.formData.id):this.editFormData={},"details"==this.pageType&&(this.formConfig.itemArr.map((function(e){return e.disabled=!0})),this.attachSetting.sourceId=this.formData.id)},getFormData:function(){var e=this;return new Promise((function(t,a){e.$refs.editForm.getFormData().then((function(e){e=Object.assign({},e),t(e)})).catch((function(e){a(e)}))}))},getDetails:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,d(e);case 2:n=a.sent,o=n.data||{},t.procInstType=o.procInstType,t.attachSetting.sourceId=o.id,t.editFormData=Object.assign({},o,{confirmMan:o.empId,confirmManName:o.zystaffunName});case 7:case"end":return a.stop()}}),a)})))()},getDevelopers:function(){if("details"!=this.pageType){var e=this.$refs.editForm.getFormItem("sourceId");this.hadSeleteData=[{id:e}],this.showSelete=!0}},selectDevelopers:function(e){var t=Object(i["a"])(e,1),a=t[0],n=(a.comNumber,a.comFullName),o=(a.comAddress,a.comTel),r=(a.comPerson,a.personMobile,a.id);this.$refs.editForm.setFormItem("companyId",r),this.$refs.editForm.setFormItem("comName",n),this.$refs.editForm.setFormItem("phone",o)}}},g=f,b=a("2877"),y=Object(b["a"])(g,r,s,!1,null,"572ae84a",null),D=y.exports,v={name:"assetParameter",components:{addInfo:D},data:function(){var e=this;return{label:"",maxNum:0,currentItem:{},tableConfig:{showFixedHeight:!0,searchObj:{searchMethod:function(t,a){e.tableConfig.tableDataObj&&e.getTableData()},searchArr:[{type:"daterange",label:"申请日期",model:"billDate"},{label:"主办人",model:"empName",placeholder:"主办人",type:"el-input"},{label:"系统名称",model:"sysName",placeholder:"系统名称",type:"el-input"}]},queryObj:{method:function(){e.getTableData()},queryData:{page:1,pageSize:15}},tableDataObj:{tableArr:[],total:null},operateArr:[{name:"新建",isHide:!1,icon:"el-icon-plus",method:function(t){e.pageType="add"}}],tableObj:{selectionShow:!1,indexShow:!0,tableMethods:{selection:function(t){e.selectionData=t}},showItems:[{name:"系统名称",prop:"sysName"},{name:"建设日期",prop:"buildDate"},{name:"预计完工日期",prop:"planDate"},{name:"上线时间",prop:"onlineDate"},{name:"开发商",prop:"comName",id:"companyId"},{name:"联系电话",prop:"phone"},{name:"主办人",prop:"empName"},{name:"操作",prop:"operate",width:100,scopeType:"button",fixed:"right",buttonArr:[{name:"详情",method:function(t){e.detailsInfo(t)},isShow:function(e,t){return!0},icon:"false"},{name:"编辑",method:function(t){e.editInfo(t)},isShow:function(e,t){return!0},icon:"false"},{name:"删除",method:function(t){e.deleteInfo(t)},isShow:function(e,t){return!0},icon:"false"}]}]},paginationObj:{pageSizes:[15,30,50,100]},paginationIsshow:!0,showklTable:!1},pageType:"list",selectType:null,formData:{}}},watch:{pageType:function(e){"list"===e&&this.getTableData()}},computed:{rightBtnArr:function(){var e=this,t=[{text:"保存",icon:"el-icon-finished",hide:"details"==this.pageType,methods:function(){e.doSubmit()}}];return t}},mounted:function(){this.getTableData()},methods:{getTableData:function(){var e=this,t=Object.assign({},this.tableConfig.queryObj.queryData);t.pageCount=t.pageSize;var a=t.billDate;if(a){var n=Object(i["a"])(a,2),o=n[0],r=n[1];t.beginDate=o,t.endDate=r}this.$delete(t,"billDate"),this.$delete(t,"pageSize"),p(t).then((function(t){e.$set(e.tableConfig.tableDataObj,"tableArr",t.data.list||[]),e.$set(e.tableConfig.tableDataObj,"total",t.data.total||0)})).catch((function(t){e.$set(e.tableConfig.tableDataObj,"tableArr",[]),e.$set(e.tableConfig.tableDataObj,"total",0)}))},detailsInfo:function(e){this.pageType="details",this.formData=Object.assign({},e)},editInfo:function(e){this.formData=Object.assign({},e),this.pageType="edit"},deleteInfo:function(e){var t=this;this.$confirm("是否确认删除","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){m(e.id).then((function(e){t.$message.success("操作成功"),t.getTableData()}))})).catch((function(e){}))},doSubmit:function(e){var t=this;this.$refs.editForm.getFormData().then((function(a){var n=function(e){return e.id?h(e):u(e)};n(a).then((function(a){t.$message.success("操作成功！"),2==e?(t.pageType="edit",a.data&&(t.formData.id=a.data),t.$refs.editForm.getDetails(t.formData.id)):t.pageType="list"}))})).catch((function(e){console.log(e)}))},addMethons:function(e){return this.$delete(e,"staffunName"),e.id?new Promise((function(t,a){updateRegist(e).then((function(e){t(e)})).catch((function(e){console.log(e),a(e)}))})):new Promise((function(t,a){addRegist(e).then((function(e){t(e)})).catch((function(e){console.log(e),a(e)}))}))},goBackPage:function(e){this.pageType="list"}}},T=v,w=Object(b["a"])(T,n,o,!1,null,null,null);t["default"]=w.exports}}]);
//# sourceMappingURL=chunk-2d2163f6.6a95ad36.js.map